<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>remap CSV 📄🔄️</title>
    <!-- Bootstrap v5.3.3 CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container mt-5">
      <h1 class="mb-4">remap CSV 📄🔄️</h1>

      <!-- CSV File Input -->
      <div class="mb-3">
        <label for="csvFileInput" class="form-label">Select CSV File</label>
        <input
          type="file"
          class="form-control"
          id="csvFileInput"
          accept=".csv"
        />
      </div>

      <!-- Mapping Selection -->
      <div id="mappingSelectSection" class="mb-4" style="display: none">
        <label for="mappingSelect" class="form-label">Select Mapping</label>
        <select id="mappingSelect" class="form-select">
          <option value="custom" selected>Custom Mapping</option>
          <!-- Options from mappings.json will be added here -->
        </select>
      </div>

      <!-- Mapping UI -->
      <div id="mappingSection" class="mb-4" style="display: none">
        <div class="mb-3">
          <button id="processBtn" class="btn btn-success me-5">
            Process CSV
          </button>

          <button id="addColumnBtn" class="btn btn-sm btn-secondary">
            Add New Column
          </button>
          <button id="saveMappingBtn" class="btn btn-sm btn-secondary">
            Save Mapping
          </button>
          <button id="loadMappingBtn" class="btn btn-sm btn-secondary">
            Load Saved Mapping
          </button>
        </div>
        <h2>Column Mapping</h2>
        <p>
          Edit the mapping rules for each column:
          <br /><strong>Normal Mapping:</strong> Enter the new column name.
          <br /><strong>Fixed Mapping:</strong> Use
          <code>fixed:ColumnName|FixedValue</code> to create a column with a
          custom header and fixed value. <br /><strong
            >Conditional Split Mapping:</strong
          >
          Use <code>split:NegativeHeader|PositiveHeader</code> to split a
          numeric value. For example, if the value is negative, the absolute
          value will be placed under <em>NegativeHeader</em>; if positive, under
          <em>PositiveHeader</em>. <br />Leave the field empty to omit the
          column from the output.
        </p>
        <table class="table" id="mappingTable">
          <thead>
            <tr>
              <th>Original Column</th>
              <th>Mapping Rule</th>
            </tr>
          </thead>
          <tbody>
            <!-- Mapping rows will be generated dynamically from the CSV header -->
          </tbody>
        </table>
      </div>

      <!-- Download Link (hidden, auto-triggered) -->
      <div id="downloadSection" style="display: none">
        <a id="downloadLink" class="btn btn-info" href="#">Download CSV</a>
      </div>
    </div>

    <!-- JavaScript -->
    <script src="main.js"></script>
    <!-- Bootstrap v5.3.3 Bundle JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
